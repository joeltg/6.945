/* embedded.js cef67c8 */
'use strict';var f;function h(a,b){for(var c in b)a[c]=b[c]}function k(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a}
function aa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ba(a){return a[ca]||(a[ca]=++da)}var ca="closure_uid_"+(1E9*Math.random()>>>0),da=0;function ea(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}};function fa(){this.Kb='; Copyright 2011-2014 Brendan Linn\n;\n; This program is free software: you can redistribute it and/or modify\n; it under the terms of the GNU General Public License as published by\n; the Free Software Foundation, either version 3 of the License, or\n; (at your option) any later version.\n;\n; This program is distributed in the hope that it will be useful,\n; but WITHOUT ANY WARRANTY; without even the implied warranty of\n; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n; GNU General Public License for more details.\n;\n; You should have received a copy of the GNU General Public License\n; along with this program.  If not, see \x3chttp://www.gnu.org/licenses/\x3e.\n\n\t\t\t\t\t; R5RS 6.5: "Null-environment returns a specifier for an environment that is\n\t\t\t\t\t; empty except for the (syntactic) bindings for all syntactic keywords\n\t\t\t\t\t; defined in this report that are either required or both optional and\n\t\t\t\t\t; supported by the implementation."\n\n(define-syntax cond\n  (syntax-rules (else \x3d\x3e)\n    ((cond (else result1 result2 ...))\n     (begin result1 result2 ...))\n    ((cond (test \x3d\x3e result))\n     (let ((temp test))\n       (if temp (result temp))))\n    ((cond (test \x3d\x3e result) clause1 clause2 ...)\n     (let ((temp test))\n       (if temp\n\t   (result temp)\n\t   (cond clause1 clause2 ...))))\n    ((cond (test)) test)\n    ((cond (test) clause1 clause2 ...)\n     (let ((temp test))\n       (if temp\n\t   temp\n           (cond clause1 clause2 ...))))\n    ((cond (test result1 result2 ...))\n     (if test (begin result1 result2 ...)))\n    ((cond (test result1 result2 ...)\n           clause1 clause2 ...)\n     (if test\n         (begin result1 result2 ...)\n         (cond clause1 clause2 ...)))))\n\n(define-syntax case\n  (syntax-rules (else)\n    ((case (key ...)\n       clauses ...)\n     (let ((atom-key (key ...)))\n       (case atom-key clauses ...)))\n    ((case key\n       (else result1 result2 ...))\n     (begin result1 result2 ...))\n    ((case key\n       ((atoms ...) result1 result2 ...))\n     (if (memv key \'(atoms ...))\n         (begin result1 result2 ...)))\n    ((case key\n       ((atoms ...) result1 result2 ...)\n       clause clauses ...)\n     (if (memv key \'(atoms ...))\n         (begin result1 result2 ...)\n         (case key clause clauses ...)))))\n\n(define-syntax or\n  (syntax-rules ()\n    ((or) #f)\n    ((or test) test)\n    ((or test1 test2 ...)\n     (let ((x test1))\n       (if x x (or test2 ...))))))\n\n(define-syntax let\n  (syntax-rules ()\n    ((let ((name val) ...) body1 body2 ...)\n     ((lambda (name ...) body1 body2 ...)\n      val ...))\n    ((let tag ((name val) ...) body1 body2 ...)\n     ((letrec ((tag (lambda (name ...)\n                      body1 body2 ...)))\n\ttag) val ...))))\n\n(define-syntax and\n  (syntax-rules ()\n    ((and) #t)\n    ((and test) test)\n    ((and test1 test2 ...)\n     (if test1 (and test2 ...) #f))))\n\n(define-syntax let*\n  (syntax-rules ()\n    ((let* () body1 body2 ...)\n     (let () body1 body2 ...))\n    ((let* ((name1 val1) (name2 val2) ...)\n       body1 body2 ...)\n     (let ((name1 val1))\n       (let* ((name2 val2) ...)\n\t body1 body2 ...)))))\n\n; todo bl this official version seems too pedantic, with\n; the renaming of variables. Is it OK to simplify?\n(define-syntax letrec\n  (syntax-rules ()\n    ((letrec ((var1 init1) ...) body ...)\n     (letrec "generate_temp_names"\n       (var1 ...)\n       ()\n       ((var1 init1) ...)\n       body ...))\n    ((letrec "generate_temp_names"\n       ()\n       (temp1 ...)\n       ((var1 init1) ...)\n       body ...)\n     (let ((var1 \'fuck) ...) ; todo bl\n       (let ((temp1 init1) ...)\n\t (set! var1 temp1)\n\t ...\n\t body ...)))\n    ((letrec "generate_temp_names"\n       (x y ...)\n       (temp ...)\n       ((var1 init1) ...)\n       body ...)\n     (letrec "generate_temp_names"\n       (y ...)\n       (newtemp temp ...)\n       ((var1 init1) ...)\n       body ...))))\n\n(define-syntax do\n  (syntax-rules ()\n    ((do ((var init step ...) ...)\n\t (test expr ...)\n       command ...)\n     (letrec\n\t ((loop\n\t   (lambda (var ...)\n\t     (if test\n\t\t (begin\n\t\t   (if #f #f)\n\t\t   expr ...)\n\t\t (begin\n\t\t   command\n\t\t   ...\n\t\t   (loop (do "step" var step ...)\n\t\t\t ...))))))\n       (loop init ...)))\n    ((do "step" x)\n     x)\n    ((do "step" x y)\n     y)))\n\n(define-syntax delay\n  (syntax-rules ()\n    ((delay expression)\n     (make-promise (lambda () expression)))))';
this.Ib="; Copyright 2011-2014 Brendan Linn\n;\n; This program is free software: you can redistribute it and/or modify\n; it under the terms of the GNU General Public License as published by\n; the Free Software Foundation, either version 3 of the License, or\n; (at your option) any later version.\n;\n; This program is distributed in the hope that it will be useful,\n; but WITHOUT ANY WARRANTY; without even the implied warranty of\n; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n; GNU General Public License for more details.\n;\n; You should have received a copy of the GNU General Public License\n; along with this program.  If not, see \x3chttp://www.gnu.org/licenses/\x3e.\n\n; This file contains definitions for almost all the procedures in chapter 6\n; of R5RS listed as \"library procedures\".\n;\n; In a few cases, I have chosen to implement library procedures\n; as primitive procedures. These decisions are explained in comments\n; in this file.\n;\n; This file also contains some helper functions that were useful in\n; implementing the library procedures.\n\n(define (equal? x y) ; p. 19\n  (cond\n   ((and (pair? x) (pair? y))\n    (and (equal? (car x) (car y))\n\t (equal? (cdr x) (cdr y))))\n   ((and (vector? x) (vector? y))\n    (equal? (vector-\x3elist x) (vector-\x3elist y)))\n   ((and (string? x) (string? y))\n    (equal? (string-\x3elist x) (string-\x3elist y)))\n   (else (eqv? x y))))\n\n(define (zero? z) (\x3d z 0)) ; p. 22\n\n(define (positive? x) (\x3e x 0)) ; p. 22\n\n(define (negative? x) (\x3c x 0)) ; p. 22\n\n(define (odd? n) (\x3d 1 (remainder n 2))) ; p. 22\n\n(define (even? n) (\x3d 0 (remainder n 2))) ; p. 22\n\n(define (max x . ys) ; p. 22\n  (if (null? ys)\n      x\n      (foldl\n       (lambda (y z) (if (\x3c y z) z y))\n       x\n       ys)))\n\n(define (min x . ys) ; p. 22\n  (if (null? ys)\n      x\n      (foldl\n       (lambda (y z) (if (\x3c y z) y z))\n       x\n       ys)))\n\n(define (abs x) (if (\x3e x 0) x (- x))) ; p. 22\n\n(define (euclid p q) ; helper, not in R5RS\n  (cond\n   ((\x3d q 0) p)\n   ((\x3c p q) (euclid q p))\n   (else (euclid q (modulo p q)))))\n\n(define (gcd . ns) ; p. 23\n  (foldl (lambda (l r) (euclid l (abs r))) 0 ns))\n\n(define (lcm2 p q) ; helper, not in R5RS\n  (/ (* p q) (euclid p q)))\n\n(define (lcm . ns) ; p. 23\n  (foldl (lambda (l r) (lcm2 l (abs r))) 1 ns))\n\n(define (not p) (if p #f #t)) ; p. 25\n\n; Note: boolean? is listed as a library procedure, and can\n; easily be implemented as\n; (define (boolean? p)\n;   (or (eqv? p #t) (eqv? p #f)))\n; In this implementation, all of the basic type predicates\n; are primitive procedures because they are used to do\n; rudimentary (\"primitive\"?) typechecking on the arguments to\n; primitive procedures.\n\n(define (foldr f start xs) ; helper function, not in R5RS\n  (if (null? xs)\n      start\n      (f (car xs) (foldr f start (cdr xs)))))\n\n(define (compose . fs) ; helper function, not in R5RS\n  (foldr\n   (lambda (l r) (lambda (x) (l (r x))))\n   (lambda (y) y)\n   fs))\n\n(define caar (compose car car)) ; p. 26\n(define cadr (compose car cdr))\n(define cdar (compose cdr car))\n(define cddr (compose cdr cdr))\n\n(define caaar (compose car car car)) ; p. 26\n(define caadr (compose car car cdr))\n(define cadar (compose car cdr car))\n(define caddr (compose car cdr cdr))\n(define cdaar (compose cdr car car))\n(define cdadr (compose cdr car cdr))\n(define cddar (compose cdr cdr car))\n(define cdddr (compose cdr cdr cdr))\n\n(define caaaar (compose car car car car)) ; p. 26\n(define caaadr (compose car car car cdr))\n(define caadar (compose car car cdr car))\n(define caaddr (compose car car cdr cdr))\n(define cadaar (compose car cdr car car))\n(define cadadr (compose car cdr car cdr))\n(define caddar (compose car cdr cdr car))\n(define cadddr (compose car cdr cdr cdr))\n(define cdaaar (compose cdr car car car))\n(define cdaadr (compose cdr car car cdr))\n(define cdadar (compose cdr car cdr car))\n(define cdaddr (compose cdr car cdr cdr))\n(define cddaar (compose cdr cdr car car))\n(define cddadr (compose cdr cdr car cdr))\n(define cdddar (compose cdr cdr cdr car))\n(define cddddr (compose cdr cdr cdr cdr))\n\n(define (list? l)\n  ; The interview staple: find a cycle in a linked list.\n  ;\n  ; The main idea is to send one pointer through the list hitting every node,\n  ; and another pointer through the list hitting every second node. If there\n  ; is a cycle of length n, the two pointers will eventually coincide.\n  ;\n  ; Proof: suppose pointers X and Y start at positions x and y\n  ; respectively on the cycle, 0 \x3c\x3d x,y \x3c n. After k moves:\n  ;\n  ; X is at x+k (mod n)\n  ; Y is at y+2k (mod n)\n  ;\n  ; So we just have to show that\n  ;\n  ; x+k \x3d y+2k (mod n)\n  ;\n  ; always has a solution. Sure:\n  ;\n  ; k \x3d x-y (mod n)\n  ;\n  ; so the two pointers coincide after fewer than n steps.\n  (define (detect-cycle x y)\n    (cond ((null? x) (list? y)) ; x finished first, just check y is ok\n\t  ((null? y) (list? x)) ; y finished first, just check x is ok\n\t  ((or (not (pair? x)) (not (pair? y)))\n\t   #f) ; x or y is not a pair: fail\n\t  ((eq? x y) #f) ; cycle: fail\n\t  (else\n\t   (let* ((next-x (cdr x))\n\t\t  (next-y (cdr y)))\n\t     (cond ((null? next-y) (list? next-x)) ; y finished, just check x is ok\n\t\t   ((not (pair? next-y)) #f) ; next-y is not a pair: fail\n\t\t   (else ; advance x by 1 and y by 2\n\t\t    (detect-cycle next-x (cdr next-y))))))))\n  (cond ((null? l) #t) ; various corner cases before input to detect-cycle\n\t((not (pair? l)) #f)\n\t((null? (cdr l))\n\t (if (pair? (car l)) ; not sure about this but seems to be required...\n\t     (detect-cycle (car l) (caar l))\n\t     #t))\n\t((not (pair? (cdr l))) #f)\n\t(else (detect-cycle l (cdr l)))))\n\n(define (list . xs) xs) ; p. 27\n\n(define (foldl f start xs) ; helper function, not in R5RS\n  (if (null? xs)\n      start\n      (foldl f (f start (car xs)) (cdr xs))))\n\n(define (length xs) ; p. 27\n  (foldl\n   (lambda (x y) (+ x 1))\n   0\n   xs))\n\n(define (append . xs) ; p. 27\n  (define (append2 xs ys)\n    (if (null? xs)\n\tys\n\t(cons (car xs) (append2 (cdr xs) ys))))\n  (foldl append2 '() xs))\n\n(define (flip f) (lambda (x y) (f y x))) ; helper function, not in R5RS\n\n(define (reverse xs) (foldl (flip cons) '() xs)) ; p. 27\n\n(define (list-tail xs k) ; p. 27\n  (if (\x3d k 0)\n      xs\n      (list-tail (cdr xs) (- k 1))))\n\n(define (list-ref xs k) (car (list-tail xs k))) ; p. 27\n\n(define (member-abstract are-equal?) ; helper function, not in R5RS\n  (lambda (x ys)\n    (if (null? ys)\n\t#f\n\t(if (are-equal? x (car ys))\n\t    ys\n\t    ((member-abstract are-equal?) x (cdr ys))))))\n\n(define memq (member-abstract eq?)) ; p. 27\n(define memv (member-abstract eqv?)) ; p. 27\n(define member (member-abstract equal?)) ; p. 27\n\n(define (find xs predicate?) ; helper function, not in R5RS\n  (cond\n   ((null? xs) #f)\n   ((predicate? (car xs)) (car xs))\n   (else (find (cdr xs) predicate?))))\n\n(define (assq obj alist) ; p. 27\n  (find\n   alist\n   (lambda (pair) (eq? (car pair) obj))))\n\n(define (assv obj alist) ; p. 27\n  (find\n   alist\n   (lambda (pair) (eqv? (car pair) obj))))\n\n(define (assoc obj alist) ; p. 27\n  (find\n   alist\n   (lambda (pair) (equal? (car pair) obj))))\n\n; These two are listed as library procedures, but I don't see how\n; to implement them in Scheme without having a big switch on each character,\n; and I'm not going to do that.\n; (define char-upcase [primitive]) ; p. 29\n; (define char-downcase [primitive]) ; p. 29\n\n(define (char-ci-abstract pred?)\n  (lambda (c1 c2)\n    (pred? (char-downcase c1)\n\t   (char-downcase c2))))\n\n(define char-ci\x3d? (char-ci-abstract char\x3d?)) ; p. 29\n(define char-ci\x3c? (char-ci-abstract char\x3c?)) ; p. 29\n(define char-ci\x3e? (char-ci-abstract char\x3e?)) ; p. 29\n(define char-ci\x3c\x3d? (char-ci-abstract char\x3c\x3d?)) ; p. 29\n(define char-ci\x3e\x3d? (char-ci-abstract char\x3e\x3d?)) ; p. 29\n\n(define (string . cs) ; p. 30\n  (let ((new-string (make-string (length cs))))\n    (foldl\n     (lambda (l r) (string-set! new-string l r) (+ l 1))\n     0\n     cs)\n    new-string))\n\n(define (lexicographic true-if goto-next-if compare-lengths-at-end) ; helper function, not in R5RS\n  (lambda (str1 str2)\n    (let* ((len1 (string-length str1))\n\t   (len2 (string-length str2))\n\t   (len (min len1 len2)))\n      (define (lexico-tail i)\n\t(if (\x3d i len)\n\t    (compare-lengths-at-end len1 len2)\n\t    (let* ((yes\n\t\t    (true-if (string-ref str1 i)\n\t\t\t     (string-ref str2 i)))\n\t\t   (maybe\n\t\t    (goto-next-if (string-ref str1 i)\n\t\t\t\t  (string-ref str2 i))))\n\t      (cond\n\t       (yes #t)\n\t       (maybe (lexico-tail (+ i 1)))\n\t       (else #f)))))\n      (lexico-tail 0))))\n\n(define string\x3d?     (lexicographic (lambda (x y) #f) char\x3d? \x3d)) ; p. 30\n(define string-ci\x3d?  (lexicographic (lambda (x y) #f) char-ci\x3d? \x3d))\n(define string\x3c?     (lexicographic char\x3c? char\x3d? \x3c))\n(define string\x3e?     (lexicographic char\x3e? char\x3d? \x3e))\n(define string\x3c\x3d?    (lexicographic char\x3c? char\x3d? \x3c\x3d))\n(define string\x3e\x3d?    (lexicographic char\x3e? char\x3d? \x3e\x3d))\n(define string-ci\x3c?  (lexicographic char-ci\x3c? char-ci\x3d? \x3c))\n(define string-ci\x3e?  (lexicographic char-ci\x3e? char-ci\x3d? \x3e))\n(define string-ci\x3c\x3d? (lexicographic char-ci\x3c? char-ci\x3d? \x3c\x3d))\n(define string-ci\x3e\x3d? (lexicographic char-ci\x3e? char-ci\x3d? \x3e\x3d))\n\n(define (substring str start end) ; p. 30\n  (letrec ((new-str (make-string (- end start)))\n\t (substr-tail\n\t  (lambda (i)\n\t    (string-set! new-str (- i start) (string-ref str i))\n\t    (if (\x3d i start)\n\t\tnew-str\n\t\t(substr-tail (- i 1))))))\n    (if (\x3d start end)\n\tnew-str\n\t(substr-tail (- end 1)))))\n\n(define (string-append . strs) ; p. 30\n  (define (string-append2 str1 str2)\n    (let* ((len1 (string-length str1))\n\t   (len2 (string-length str2))\n\t   (new-str (make-string (+ len1 len2))))\n      (do\n\t  ((i 0 (+ i 1)))\n\t  ((\x3d i len1) new-str)\n\t(string-set! new-str i (string-ref str1 i)))\n      (do\n\t  ((i 0 (+ i 1)))\n\t  ((\x3d i len2) new-str)\n\t(string-set! new-str (+ len1 i) (string-ref str2 i)))))\n  (foldl string-append2 \"\" strs))\n\n(define (string-\x3elist str) ; p. 30\n  (let ((new-list '())\n\t(len (string-length str)))\n    (do\n\t((i 0 (+ i 1)))\n\t((\x3d i len) new-list)\n      (set! new-list\n\t    (cons (string-ref str (- len i 1))\n\t\t  new-list)))))\n\n(define (list-\x3estring cs) ; p. 30\n  (let ((new-str\n\t (make-string (length cs))))\n  (foldl\n   (lambda (l r)\n     (string-set! new-str l r)\n     (+ l 1))\n   0\n   cs)\n  new-str))\n\n(define (string-copy str) ; p. 30\n  (let* ((len (string-length str))\n\t (new-str (make-string len)))\n    (do\n\t((i 0 (+ i 1)))\n\t((\x3d i len) new-str)\n      (string-set! new-str i (string-ref str i)))))\n\n(define (string-fill! str c) ; p. 31\n  (do\n      ((i 0 (+ i 1)))\n      ((\x3d i (string-length str)) (if #f #f)) ; unspecified value\n    (string-set! str i c)))\n\n(define (list-\x3evector xs) ; p. 31\n  (let ((v (make-vector (length xs))))\n    (foldl\n     (lambda (l r)\n       (vector-set! v l r)\n       (+ l 1))\n     0\n     xs)\n    v))\n\n(define (vector . xs) (list-\x3evector xs)) ; p. 31\n\n(define (vector-\x3elist v) ; p. 31\n  (let* ((new-list '())\n\t (len (vector-length v)))\n    (do\n\t((i 0 (+ i 1)))\n\t((\x3d i len) new-list)\n      (set! new-list\n\t    (cons (vector-ref v (- len i 1))\n\t\t  new-list)))))\n\n(define (vector-fill! v f) ; p. 31\n  (do\n      ((i 0 (+ i 1)))\n      ((\x3d i (vector-length v)) (if #f #f)) ; unspecified value\n    (vector-set! v i f)))\n\n(define (transpose list-of-lists) ; helper proc, not in R5RS\n  (cond\n   ((null? list-of-lists) '())\n   ((null? (car list-of-lists)) '())\n   (else\n    (let* ((firsts (map car list-of-lists))\n\t   (rests  (map cdr list-of-lists)))\n      (cons firsts (transpose rests))))))\n\n(define (map f l . ls) ; p. 32\n  (define (map-common f xs)\n    (foldr\n     (lambda (l r) (cons (f l) r))\n     '()\n     xs))\n  (if (null? ls)\n      (map-common f l)\n      (let ((list-of-lists (cons l ls))\n\t    (f-apply (lambda (list) (apply f list))))\n\t(map-common\n\t f-apply\n\t (transpose list-of-lists)))))\n\n(define (for-each f l . ls) ; p. 32\n  (define (for-each-common f xs)\n    (foldl\n     (lambda (l r) (f r))\n     #f\n     xs)\n    (if #f #f)) ; unspecified return value\n  (if (null? ls)\n      (for-each-common f l)\n      (let ((list-of-lists (cons l ls))\n\t    (f-apply (lambda (list) (apply f list))))\n\t(for-each-common\n\t f-apply\n\t (transpose list-of-lists)))))\n\n(define (force object) (object)) ; verbatim from p. 32\n\n(define make-promise ; verbatim from p. 33\n  (lambda (proc)\n    (let ((result-ready? #f)\n\t  (result #f))\n      (lambda ()\n\t(if result-ready?\n\t    result\n\t    (let ((x (proc)))\n\t      (if result-ready?\n\t\t  result\n\t\t  (begin (set! result-ready? #t)\n\t\t\t (set! result x)\n\t\t\t result))))))))\n\n(define (call-with-input-file string proc) ; p. 35\n  (let* ((input (open-input-file string))\n\t (result (proc input)))\n    (close-input-port input)\n    result))\n\n(define (call-with-output-file string proc) ; p. 35\n  (let* ((output (open-output-file string))\n\t (result (proc output)))\n    (close-output-port output)\n    result))\n\n(define (file-\x3estring filename) ; not in R5RS, thought it was useful\n  (define (port-\x3estring port chars)\n    (let ((maybe (read-char port)))\n      (if (eof-object? maybe)\n\t  (list-\x3estring (reverse chars))\n\t  (port-\x3estring port (cons maybe chars)))))\n  (let* ((input (open-input-file filename))\n\t (result (port-\x3estring input '())))\n    (close-input-port input)\n    result))\n\n(define (newline . maybe-port) ; p. 37\n  (if (null? maybe-port)\n      (write-char #\\newline)\n      (write-char #\\newline (car maybe-port))))\n\n(define oo\x3d\x3d\x3dD ; Turing's normal-order Y combinator (not in R5RS)\n  (lambda (g)\n    (g (delay (oo\x3d\x3d\x3dD g)))))"}
;function l(a){this.name=a}l.prototype.toString=function(){return this.name};
var ga=new l("alternate"),ha=new l("assignment"),ia=new l("command"),ja=new l("command-or-definition"),ka=new l("conditional"),la=new l("consequent"),m=new l("datum"),ma=new l("datums"),na=new l("definition"),n=new l("expression"),oa=new l("formals"),pa=new l("keyword"),qa=new l("lambda-expression"),ra=new l("list-qq-template"),sa=new l("literal"),ta=new l("macro-block"),ua=new l("macro-use"),va=new l("operand"),wa=new l("operator"),p=new l("pattern"),xa=new l("pattern-datum"),ya=new l("pattern-identifier"),
za=new l("procedure-call"),Aa=new l("program"),Ba=new l("quasiquotation"),Ca=new l("quotation"),Da=new l("qq-template"),Ea=new l("qq-template-or-splice"),Fa=new l("self-evaluating"),Ga=new l("splicing-unquotation"),Ha=new l("syntax-definition"),Ia=new l("syntax-rule"),Ja=new l("syntax-spec"),Ka=new l("template"),La=new l("template-datum"),Ma=new l("test"),Na=new l("transformer-spec"),Oa=new l("unquotation"),q=new l("variable"),Pa=new l("vector-qq-template");function Qa(a){this.I=a}Qa.prototype.getName=function(){return this.I};var r=new Qa("char"),Ra=new Qa("input-port"),t=new Qa("number"),Ta=new Qa("output-port"),Ua=new Qa("pair"),Va=new Qa("string"),Wa=new Qa("symbol"),Xa=new Qa("vector"),Ya={Mb:new Qa("boolean"),Nb:r,Ob:new Qa("environment-specifier"),Pb:Ra,Qb:t,Rb:Ta,Sb:Ua,Tb:new Qa("procedure"),Ub:Va,Vb:Wa,Wb:Xa};function u(a){this.type=a}u.prototype.kb=function(a){return this.type===a.type};function v(){return new u(Za)}function w(){return new u($a)}function ab(){return new u(bb)}var $a="argument type error",bb="immutable error",Za="internal interpreter error";function x(a){this.h=a||"@"+ba(this);this.p=this.f=null}x.prototype.T=function(){};x.prototype.M=function(a){this.p=a};x.prototype.k=function(){return this.p};x.prototype.g=function(a){this.f=a};function cb(a,b){y(a.f&&a.f.k()||a.p,a.h,b)}function z(a){var b=a.f;return b?z(b):a};function db(a,b,c){x.call(this);this.Lb=a;this.pa=b;this.ma=c;this.ib=z(this.pa);this.bb=z(this.ma)}(function(){function a(){}a.prototype=x.prototype;db.Yb=x.prototype;db.prototype=new a;db.prototype.constructor=db;db.Xb=function(a,c,d){for(var e=Array(arguments.length-2),g=2;g<arguments.length;g++)e[g-2]=arguments[g];return x.prototype[c].apply(a,e)}})();db.prototype.M=function(a){this.pa.k()||this.pa.M(a);this.ma.k()||this.ma.M(a)};db.prototype.k=function(){return null};
db.prototype.T=function(a,b){!1===b.get(this.Lb)?(this.bb.g(this.f),this.bb.h=this.h,a.g(this.ma),this.pa.p=null):(this.ib.g(this.f),this.ib.h=this.h,a.g(this.pa),this.ma.p=null)};function eb(){this.mb=this.Fa=null}function fb(a,b){a.Fa?a.mb.g(b):a.Fa=b;a.mb=z(b)};function gb(a){return!(!a||!a["$r5js.IEnvironment"])};function hb(a){a.prototype["$r5js.IPair"]=!0};function ib(a){switch(a){case "begin":case "define":case "define-syntax":case "if":case "lambda":case "let-syntax":case "letrec-syntax":case "quasiquote":case "quote":case "set!":case "unquote":case "unquote-splicing":return!0;default:return!1}};function jb(a){this.$a=a;this.Ia={};this.tb={}}jb.prototype.fa=function(){return this.Ia};function kb(a){this.i={};this.K=a}function lb(a,b){var c="@"+ba({});return a.i[b]=c}function mb(a,b){var c=a.i[b];return c?c:a.K?mb(a.K,b):null};function A(){this.K=this.c=null;this.V=[];this.Da=[];this.ba=-1;this.H=!1}function nb(a){a.H=!0;return a}f=A.prototype;f.getParent=function(){return this.K};f.clone=function(a){var b=new this.constructor;this.K&&(b.K=this.K);this.c||(b.K=a);this.H&&(b.H=!0);return b};function ob(a){var b=a.V.length;return 0<b?a.V[b-1]:null}function pb(a,b){if(a.V)for(var c=a.V.length,d=0;d<c;++d)if(a.V[d]===b)return!0;return!1}f.A=function(){return!1};f.Ka=function(){-1===this.ba&&(this.ba+=this.Da.length)};
f.e=function(a,b){var c=0<=this.ba?this.Da[this.ba--]:null,c=c?c(this,a):this;b&&c instanceof A&&(c=c.N());return c};function qb(a,b){for(var c=null,d=void 0,e=null,g=a;g;g=g.c)if(d=g.e(b))d=d instanceof A?d.N():d,c?e&&e.g(d):c=d,e=z(d);return c}f.ra=function(a){return this===a};f.ca=function(){return this};function rb(a){return a.c?rb(a.c):a}f.F=function(a){this.c&&this.c.F(a)};f.N=function(){return new sb(this)};function sb(a,b){x.call(this,b);this.j=a}k(sb,x);
sb.prototype.T=function(a){null!==this.j&&(cb(this,this.j),a.O=this.j);var b=this.f;b&&a.g(b)};function tb(a){this.f=a;this.ha=null}var ub={};function vb(){A.call(this)}h(vb,A);k(vb,A);function B(){this.r=this.v=null}B.prototype.Ga=function(){return!this.v};function C(a,b){a.v?a.r.c=b:a.v=b;a.r=rb(b);return a}function wb(a){return a.v}function F(a,b){var c=new b(a.v);a.r&&c&&(a.r.K=c);return c};var xb=new A;function H(a){A.call(this);this.b=a}h(H,vb);k(H,vb);H.prototype.ra=function(a){return this.constructor===a.constructor&&this.b===a.b};function yb(a,b){a.b=b}H.prototype.clone=function(a){a=vb.prototype.clone.call(this,a);a.b=this.b;return a};H.prototype.isEqual=function(a){return a instanceof H&&this.b===a.b};H.prototype.ca=function(){return this.b};function I(a){H.call(this,a)}h(I,H);k(I,H);I.prototype.F=function(a){ib(this.b)&&(a=mb(a,this.b))&&(this.b=a)};I.prototype.N=function(){return new zb(this)};function zb(a,b){x.call(this,b);this.j=a}k(zb,x);zb.prototype.T=function(a){var b=this.k().get(this.j.b);null!==b&&(cb(this,b),a.O=b);(b=this.f)&&a.g(b)};function Ab(a){H.call(this,a)}h(Ab,H);k(Ab,H);Ab.prototype.ca=function(){return this};function Bb(a){H.call(this,a)}h(Bb,H);k(Bb,H);function Cb(a){H.call(this,a)}h(Cb,H);k(Cb,H);function Db(a){H.call(this,a)}h(Db,H);k(Db,H);function Eb(a){H.call(this,a)}h(Eb,H);k(Eb,H);function Fb(a){H.call(this,a)}h(Fb,H);k(Fb,H);Fb.prototype.ra=function(a){return this===a};Fb.prototype.ca=function(){return this};var Gb=/[esfdli#\/]/i,Hb=/[i@]/i;
function Ib(a){this.Za=a;this.Xa=0;this.La=/((?:(?:#d(?:#i|#e)?|(?:#i|#e)?#d|(?:#i|#e))?(?:(?:[\-\+]?(?:(?:\d+#*)\/(?:\d+#*)|(?:\.\d+#*(?:[esfdl][\-\+]?\d+)?|\d+\.\d*#*(?:[esfdl][\-\+]?\d+)?|\d+#+\.#*(?:[esfdl][\-\+]?\d+)?|(?:\d+#*)(?:[esfdl][\-\+]?\d+)?)|(?:\d+#*)))@(?:[\-\+]?(?:(?:\d+#*)\/(?:\d+#*)|(?:\.\d+#*(?:[esfdl][\-\+]?\d+)?|\d+\.\d*#*(?:[esfdl][\-\+]?\d+)?|\d+#+\.#*(?:[esfdl][\-\+]?\d+)?|(?:\d+#*)(?:[esfdl][\-\+]?\d+)?)|(?:\d+#*)))|(?:[\-\+]?(?:(?:\d+#*)\/(?:\d+#*)|(?:\.\d+#*(?:[esfdl][\-\+]?\d+)?|\d+\.\d*#*(?:[esfdl][\-\+]?\d+)?|\d+#+\.#*(?:[esfdl][\-\+]?\d+)?|(?:\d+#*)(?:[esfdl][\-\+]?\d+)?)|(?:\d+#*)))[\+\-](?:(?:\d+#*)\/(?:\d+#*)|(?:\.\d+#*(?:[esfdl][\-\+]?\d+)?|\d+\.\d*#*(?:[esfdl][\-\+]?\d+)?|\d+#+\.#*(?:[esfdl][\-\+]?\d+)?|(?:\d+#*)(?:[esfdl][\-\+]?\d+)?)|(?:\d+#*))i|(?:[\-\+]?(?:(?:\d+#*)\/(?:\d+#*)|(?:\.\d+#*(?:[esfdl][\-\+]?\d+)?|\d+\.\d*#*(?:[esfdl][\-\+]?\d+)?|\d+#+\.#*(?:[esfdl][\-\+]?\d+)?|(?:\d+#*)(?:[esfdl][\-\+]?\d+)?)|(?:\d+#*)))[\+\-]i|[\\-]+(?:(?:\d+#*)\/(?:\d+#*)|(?:\.\d+#*(?:[esfdl][\-\+]?\d+)?|\d+\.\d*#*(?:[esfdl][\-\+]?\d+)?|\d+#+\.#*(?:[esfdl][\-\+]?\d+)?|(?:\d+#*)(?:[esfdl][\-\+]?\d+)?)|(?:\d+#*))i|[\+\-]i|(?:[\-\+]?(?:(?:\d+#*)\/(?:\d+#*)|(?:\.\d+#*(?:[esfdl][\-\+]?\d+)?|\d+\.\d*#*(?:[esfdl][\-\+]?\d+)?|\d+#+\.#*(?:[esfdl][\-\+]?\d+)?|(?:\d+#*)(?:[esfdl][\-\+]?\d+)?)|(?:\d+#*)))))|(?:(?:#x(?:#i|#e)?|(?:#i|#e)?#x)(?:(?:[\-\+]?(?:(?:[\da-f]+#*)\/(?:[\da-f]+#*)|(?:[\da-f]+#*)))@(?:[\-\+]?(?:(?:[\da-f]+#*)\/(?:[\da-f]+#*)|(?:[\da-f]+#*)))|(?:[\-\+]?(?:(?:[\da-f]+#*)\/(?:[\da-f]+#*)|(?:[\da-f]+#*)))[\+\-](?:(?:[\da-f]+#*)\/(?:[\da-f]+#*)|(?:[\da-f]+#*))i|(?:[\-\+]?(?:(?:[\da-f]+#*)\/(?:[\da-f]+#*)|(?:[\da-f]+#*)))[\+\-]i|[\\-]+(?:(?:[\da-f]+#*)\/(?:[\da-f]+#*)|(?:[\da-f]+#*))i|[\+\-]i|(?:[\-\+]?(?:(?:[\da-f]+#*)\/(?:[\da-f]+#*)|(?:[\da-f]+#*)))))|(?:(?:#o(?:#i|#e)?|(?:#i|#e)?#o)(?:(?:[\-\+]?(?:(?:[0-7]+#*)\/(?:[0-7]+#*)|(?:[0-7]+#*)))@(?:[\-\+]?(?:(?:[0-7]+#*)\/(?:[0-7]+#*)|(?:[0-7]+#*)))|(?:[\-\+]?(?:(?:[0-7]+#*)\/(?:[0-7]+#*)|(?:[0-7]+#*)))[\+\-](?:(?:[0-7]+#*)\/(?:[0-7]+#*)|(?:[0-7]+#*))i|(?:[\-\+]?(?:(?:[0-7]+#*)\/(?:[0-7]+#*)|(?:[0-7]+#*)))[\+\-]i|[\\-]+(?:(?:[0-7]+#*)\/(?:[0-7]+#*)|(?:[0-7]+#*))i|[\+\-]i|(?:[\-\+]?(?:(?:[0-7]+#*)\/(?:[0-7]+#*)|(?:[0-7]+#*)))))|(?:(?:#b(?:#i|#e)?|(?:#i|#e)?#b)(?:(?:[\-\+]?(?:(?:[01]+#*)\/(?:[01]+#*)|(?:[01]+#*)))@(?:[\-\+]?(?:(?:[01]+#*)\/(?:[01]+#*)|(?:[01]+#*)))|(?:[\-\+]?(?:(?:[01]+#*)\/(?:[01]+#*)|(?:[01]+#*)))[\+\-](?:(?:[01]+#*)\/(?:[01]+#*)|(?:[01]+#*))i|(?:[\-\+]?(?:(?:[01]+#*)\/(?:[01]+#*)|(?:[01]+#*)))[\+\-]i|[\\-]+(?:(?:[01]+#*)\/(?:[01]+#*)|(?:[01]+#*))i|[\+\-]i|(?:[\-\+]?(?:(?:[01]+#*)\/(?:[01]+#*)|(?:[01]+#*))))))|(#t|#f)|(#\\space|#\\newline|#\\.)|("(?:[^"\\]|\\\"|\\\\)*")|((?:(?:[a-z]|[\!\$%&\*/\:<\=\>\?\^_~])(?:(?:[a-z]|[\!\$%&\*/\:<\=\>\?\^_~])|\d|[\+\-\.@])*)|(?:\+|\-|\.\.\.))|([\(\)'`\.]|#\(|,@|,)|((?:[ \n\r\t]|;.*$|;.*[\n\r])+)/gi;this.U=
!1;this.va=[];this.ga=0}function Jb(a,b){if(b){if(a.La.lastIndex>a.Xa+b[0].length)throw new u("scan error");a.Xa=a.La.lastIndex;var c=!!b[7];c&&(a.U=!1);return c}return!1}function Kb(a){for(;a.ga>=a.va.length;){var b;b=a;var c=void 0;do c=b.La.exec(b.Za);while(Jb(b,c));if(c)b=Lb(b,c);else{if(b.Xa===b.Za.length)b.La.lastIndex=b.Za.length;else throw new u("scan error");b=c}a.va.push(b)}return a.va[a.ga++]}
Ib.prototype.restore=function(a){for(var b=a+1;b<this.va.length;++b){var c=this.va[b];c instanceof A&&(c.c=null)}this.ga=a};
function Lb(a,b){var c=b[0];if(a.U&&!b[6])throw new u("scan error");if(b[6])return a.U=!1,c;if(b[5])return a.U=!0,new I(c);if(b[2])return a.U=!1,new Bb("#t"===c||"#T"===c);if(b[3]){a.U=!0;c=c.substr(2);if(1!==c.length)if("space"===c.toLowerCase())c=" ";else if("newline"===c.toLowerCase())c="\n";else throw v();return new Ab(c)}if(b[4])return a.U=!1,new Fb(c.substr(1,c.length-2));if(b[1]){a.U=!0;if(Gb.test(c)){var c=c.replace(/#i|#e/i,""),d=c.length;if(Hb.test(c))throw new u("scan error");var e=10;
(c=c.replace(/#x/i,"")).length<d?e=16:(c=c.replace(/#d/i,"")).length<d||((c=c.replace(/#o/i,"")).length<d?e=8:(c=c.replace(/#b/i,"")).length<d&&(e=2));c=c.replace("#","");d=c.split("/");c=2===d.length?parseInt(d[0],e)/parseInt(d[1],e):10===e?parseFloat(c.replace(/[sfdl]/i,"e")):parseInt(c,e)}else c=parseFloat(c);return new Cb(c)}throw v();};var J=new A;var Mb=new A;function K(){A.call(this);this.Y=this.d=null;this.ia=void 0}h(K,A);k(K,A);function Nb(a){return a.d}f=K.prototype;f.clone=function(a){var b=A.prototype.clone.call(this,a);if(this.d){var c=new B;Ob(this,function(a){return C(c,a.clone(b))});b.d=c.v}return b};f.isEqual=function(a){var b=void 0,b=this.d;for(a=a.d;b&&a;b=b.c,a=a.c)if(b instanceof K&&a instanceof K&&!b.isEqual(a))return!1;return!(b||a)};
f.F=function(a){if(pb(this,qa))Pb(this,a);else if(pb(this,na)){var b=L(this,q),c=void 0;if(!b){for(var d=this.d.c,b=d.d,e=new kb(a),g=b.c;g;g=g.c)c=g.b,ib(c)&&(c=lb(e,c),g.b=c);d.c.F(e)}c=b.b;ib(c)&&(c=lb(a,c),b.b=c)}else for(b=this.d;b;b=b.c)b.F(a);A.prototype.F.call(this,a)};function Pb(a,b){var c=L(a,oa),d=new kb(b);if(c instanceof I){var e=c.b;ib(e)&&yb(c,lb(d,e))}else Ob(c,function(a){var b=a.b;ib(b)&&(b=lb(d,b),a.b=b)});c.c.F(d)}
function L(a,b){for(var c=a.d;c;c=c.c)if(ob(c)===b)return c;return null}function Qb(a){for(a=a.d;a;a=a.c)if(a instanceof K)return a;return null}f.Ka=function(){A.prototype.Ka.call(this);Ob(this,function(a){return a.Ka()})};function Ob(a,b,c){for(a=a.d;a;a=a.c)b.call(c,a)}function Rb(a,b){for(var c=[],d=a.d;d;d=d.c)c.push(b.call(void 0,d));return c}
function Sb(a,b,c){for(var d=a.d,e;d;e=d,d=d.c)if(b(d)){var g=d.c;d.c=null;(d=c(d))?(e?e.c=d:a.d=d,d.c&&(d=rb(d)),d.c=g):(e.c=g,d=e)}else d instanceof K&&Sb(d,b,c);return a}f.W=function(a){Ob(this,function(b){b instanceof K&&b.W(a)});return this};function Tb(a,b,c){this.i={};this.Z=[];this.Ba=0;this.Ab=a;this.ta=b;this.ja=c;this.ub={}}function Ub(a,b,c){if(b in a.i)throw v();if(c instanceof Db){var d="@"+ba({}),e=a.Ab,g=c.b;g.Ra=!0;y(e,d,g);a.i[b]=new I(d)}else a.i[b]=c;c instanceof I?a.Sa(c):c instanceof K&&Ob(c,a.Sa,a)}Tb.prototype.Sa=function(a){a instanceof I?(a=a.b,this.ja[a]&&(this.ub[a]=!0)):a instanceof K&&Ob(a,this.Sa,this)};function Vb(a){if(a.Ba<a.Z.length)return a.Z[a.Ba++];a.Ba=0;return null}Tb.prototype.fa=function(){return this.ta};function Wb(a){this.u=a}Wb.prototype.w=function(a,b,c,d,e){if(!(this.u instanceof I))return a.isEqual(this.u);if(this.u.b in b){if(b=a instanceof I)b=a.b,(b=b===this.u.b&&!Xb(c,b)&&!Xb(d,b))||(a=a.b,b=c.get(a)===d.get(a));return b}Ub(e,this.u.b,a);return!0};Wb.prototype.za=function(a){var b=this.u;if(!a.ta)throw v();if(b instanceof I){var c=b.b,d=a.i[c];a=d?d.clone(null):void 0!==a.ta[c]?!1:b.clone(null)}else a=b.clone(null);return a};function Yb(a){this.u=a}k(Yb,Wb);
Yb.prototype.R=function(a,b){if(this.u instanceof I){var c=this.u.b;c!==b.$a&&(b.Ia[c]=a)}};function Zb(a){this.u=a}k(Zb,Wb);Zb.prototype.R=function(a,b){if(this.u instanceof I){var c=this.u.b,d=c in b.Ia?b.Ia[c]:-1;if(-1===d&&c!==b.$a)ib(c)||(b.tb[c]=!0);else if(d!==a&&c!==b.$a)throw new u("macro error");}};function $b(a){this.Ya=a}$b.prototype.w=function(a,b,c,d,e){for(a||e.Z.push(new Tb(d,e.fa(),e.ja));a;a=a.c){var g=new Tb(d,e.fa(),e.ja);if(this.Ya.w(a,b,c,d,g)){var G=e,D;a:{D=G;var E=g;if(!(0<E.Z.length))for(var S=0;S<D.Z.length;++S){var ld=D.Z[S],Sa;b:{Sa=void 0;for(Sa in E.i)if(Sa in ld.i){Sa=!1;break b}Sa=!0}if(Sa){for(var md in E.i)Ub(ld,md,E.i[md]);break a}}D=null}D||G.Z.push(g)}else return!1}return!0};
$b.prototype.za=function(a){for(var b=new B,c,d;(c=Vb(a))&&(d=this.Ya.za(c));)C(b,d);a.Ba=0;return b.v};$b.prototype.R=function(a,b){this.Ya.R(a+1,b)};function ac(a){K.call(this);a&&(this.d=a)}h(ac,K);k(ac,K);ac.prototype.W=function(a){this.ia=a;return K.prototype.W.call(this,a-1)};function bc(a){K.call(this);a&&(this.d=a)}h(bc,K);k(bc,K);bc.prototype.W=function(a){this.ia=a;return K.prototype.W.call(this,a-1)};function M(a){K.call(this);a&&(this.d=a);this.Ea=this.jb=!1}h(M,K);k(M,K);M.prototype.A=function(){return this.Ea};M.prototype.ra=function(a){if(this.Ea)return this===a;if(!(a instanceof K))return!1;if(this===a||a instanceof M&&!this.d&&!a.d)return!0;var b=this.Y,c=a.Y;return b&&c?b.kb(c):b&&a instanceof K?a?b.C===a?b.xa===a.d:!1:!1:c?this?c.C===this?c.xa===this.d:!1:!1:!1};M.prototype.Na=function(){return this.d};
M.prototype.Oa=function(){var a=this.d.c;return a?a.c||!this.jb?(a.c===a&&(a.c=null),F(C(new B,a),this.Ea?N:M)):a:F(new B,M)};hb(M);function N(a){K.call(this);a&&(this.d=a)}h(N,K);k(N,K);N.prototype.A=function(){return!0};N.prototype.Na=function(){return this.d};N.prototype.Oa=function(){var a=this.d.c,b=void 0;return a?(b=a.c?F(C(new B,a),N):a,b instanceof K&&(b.Y=new cc(this,a)),b):F(new B,M)};hb(N);function cc(a,b){this.C=a;this.xa=b}cc.prototype.kb=function(a){return this.C===a.C&&this.xa===a.xa};function dc(a){K.call(this);this.Aa=(this.na="array"==aa(a))?a:[];a instanceof A&&(this.d=a)}h(dc,K);k(dc,K);function ec(a){Ob(a,function(b){return a.Aa.push(b)},a);a.d=null;a.na=!0};function fc(a){var b=L(a,q);if(b)return a=L(a,n),b.c=null,F(C(C(new B,b),a),M);a=a.d.c;var b=a.d,c=a.c;a.d=a.d.c;var d=new B;C(d,new I("lambda"));a.A()&&!a.d.c?C(d,new I(a.d.b)):(a.c=null,C(d,a));C(d,c);a=F(d,M);b.c=null;return F(C(C(new B,b),a),M)}function gc(a){switch(typeof a){case "boolean":return new Bb(a);case "number":return new Cb(a);case "object":return a;case "string":return new I(a);default:throw v();}};function O(a){K.call(this);a&&(this.d=nb(a))}h(O,K);k(O,K);O.prototype.Na=function(){return hc};O.prototype.Oa=function(){return new M(this.d)};O.prototype.F=function(){};O.prototype.N=function(){return new ic(this)};hb(O);var hc=new I("quote");function ic(a,b){x.call(this,b);this.j=a}k(ic,x);ic.prototype.T=function(a){var b=jc(this,this.j);null!==b&&(cb(this,b),a.O=b);(b=this.f)&&a.g(b)};
function jc(a,b){var c=a.k(),d=Sb(b,function(a){return a instanceof I&&","===a.b.charAt(0)},function(a){var b=c.get(a.b),b=null===b?J:gc(b);b instanceof Eb&&(b=b.b);if(a instanceof I&&"@"===a.b.charAt(1))if(b instanceof M)b=b.d?b.d:null;else throw new u("quasiquote error");return b});return d instanceof K&&d.d?d.d:new I("quote")};function kc(a){this.ea=a;this.s=[]}function lc(a,b){a.s.push(b)}f=kc.prototype;f.getName=function(){return this.s[0].u.b};f.R=function(a,b){for(var c=0;c<this.s.length;++c)this.s[c].R(a,b)};f.qa=function(){return!1};f.za=function(a){a:{for(var b=new B,c=this.s.length,d=0;d<c;++d){var e=this.s[d].za(a);if(!1===e){a=null;break a}e&&C(b,e)}a=b}return a?F(a,this.ea):!1};
f.w=function(a,b,c,d,e){var g=this.s.length,G=this.s[g-1]instanceof $b&&this.s[g-1];if(!this.qa(a))return!1;for(var D=a.d,E=0;D&&(E!==g-1||!G);D=D.c,++E)if(E>=g||!this.s[E].w(D,b,c,d,e))return!1;return G?!a.d&&1<g?!1:G.w(D,b,c,d,e):E===g};function mc(){kc.call(this,O)}h(mc,kc);k(mc,kc);mc.prototype.R=function(){};function nc(){kc.call(this,dc)}h(nc,kc);k(nc,kc);nc.prototype.qa=function(a){return a instanceof dc};function oc(){kc.call(this,M)}h(oc,kc);k(oc,kc);
oc.prototype.qa=function(a){return a instanceof M};function pc(){kc.call(this,N)}h(pc,kc);k(pc,kc);pc.prototype.qa=function(a){return a instanceof M||a.A()};pc.prototype.w=function(a,b,c,d,e){var g=this.s.length,G=this.s[g-1]instanceof $b&&this.s[g-1];if(!this.qa(a))return!1;for(var D=a.d,E=0;D&&E!==g-1;D=D.c,++E)if(E>=g||!this.s[E].w(D,b,c,d,e))return!1;if(G)return!a.d&&1<g?!1:G.w(D,b,c,d,e);g=void 0;a instanceof M?g=F(C(new B,D),M):a.A()&&(g=D.c?F(C(new B,D),N):D);return this.s[E].w(g,b,c,d,e)};function qc(a,b){this.qb=a;this.wb=b;this.I=a.getName();var c=new jb(this.I);this.qb.R(0,c);this.wb.R(0,c);this.ta=c.fa();this.ja=c.tb}qc.prototype.w=function(a,b,c,d,e){return this.qb.w(a,b,c,d,e)};qc.prototype.getName=function(){return this.I};qc.prototype.fa=function(){return this.ta};function rc(a){K.call(this);a&&(this.d=a)}h(rc,K);k(rc,K);rc.prototype.ra=function(a){return this.isEqual(a)};function sc(a,b,c){var d=new eb,e=a.ia;Sb(a,function(a){return(a instanceof ac||a instanceof bc)&&a.ia===e},function(a){var e=c(a.d).parse(n).e(b,!0);a=(a instanceof ac?",":",@")+""+ba({});z(e).h=a;fb(d,e);return new I(a)});a=new O(a.d);fb(d,a.N());return d.Fa}rc.prototype.W=function(a){this.ia=a+1;return K.prototype.W.call(this,this.ia)};rc.prototype.N=function(){return new tc(this)};
function tc(a,b){x.call(this,b);this.j=a}k(tc,x);tc.prototype.T=function(a,b,c){b=sc(this.j,this.k(),c);(c=this.f)&&z(b).g(c);b&&a.g(b)};function uc(a){return!(!a||!a["$r5js.OutputPort"])}function vc(){}vc.prototype.close=function(){};vc.prototype.write=function(){};vc.prototype["$r5js.OutputPort"]=!0;var wc=new vc;function xc(a){return!(!a||!a["$r5js.InputPort"])}function yc(){}f=yc.prototype;f.lb=function(){return!1};f.ua=function(){return null};f.L=function(){return null};f.rb=function(){return null};f.close=function(){};yc.prototype["$r5js.InputPort"]=!0;var zc=new yc;function Ac(a,b){this.Qa=a;this.Va=b;this.J=this.eb=null;this.O=J}Ac.prototype.clear=function(){this.J=null};Ac.prototype.g=function(a){this.J=a};function Bc(a,b,c,d){this.Ca=c;for(this.ob={};a;a=a.c)this.ob[a.b]=!0;this.ka=d||[];if(!d)for(;b;b=b.c)d=L(b,p).e(c),a=L(b,Ka).e(c),d=new qc(d,a),this.ka.push(d);this.Ra=!1}Bc.prototype.clone=function(a){return new Bc(null,null,a,this.ka)};
function Cc(a,b,c,d){for(var e=void 0,g,G,D=0;D<a.ka.length;++D)if(e=a.ka[D],g=new Tb(c,e.fa(),e.ja),e.w(b,a.ob,a.Ca,c,g)&&(G=e.wb.za(g))){b=d(G).parse();var E={},e=e.ja,S;for(S in e)Xb(a.Ca,S)?y(c,S,a.Ca):ib(S)||(e="@"+ba({}),E[S]=e,g.ub[S]&&Xb(c,S)&&(d=c.get(S),null!==d&&y(c,e,d)));if(b)Sb(F(C(new B,b),M),function(a){return a instanceof I&&E[a.b]},function(a){a.b=E[a.b];return a});else throw new u("parse error");return b}throw new u("macro error");}
Bc.prototype.evaluate=function(a,b,c,d){var e=b.k(),g=new Dc(e);d=Cc(this,a,g,d);a=b.f;e&&a&&!a.k()&&a.M(e);e=d.e(g,!0);e.M(g);g=z(e);a&&g.g(a);g.h=b.h;c.g(e)};function Ec(a){x.call(this);this.j=a}k(Ec,x);Ec.prototype.T=function(a){var b=this.k().get(this.j.c.b);this.gb(b);this.pb(this.j.b,b);a.O=J;cb(this,J);(b=this.f)&&a.g(b)};Ec.prototype.gb=function(a){if(a instanceof Bc&&!a.Ra)throw v();};Ec.prototype.pb=function(a,b){Fc(this.k(),a,b,!1)};function Gc(a,b){var c=wb(C(C(new B,new I(a)),new I(b)));return new Ec(c)};function Hc(a){Ec.call(this,a)}k(Hc,Ec);Hc.prototype.pb=function(a,b){Fc(this.k(),a,b,!0)};function Ic(a,b){var c=wb(C(C(new B,new I(a)),new I(b)));return new Hc(c)};function Jc(a){Ec.call(this,a)}var Kc=Ic,Kc=Kc=Ic;k(Jc,Hc);Jc.prototype.gb=function(){};Kc=function(a,b){var c=wb(C(C(new B,new I(a)),new I(b)));return new Jc(c)};function Lc(){}Lc.prototype.evaluate=function(){throw Error("unimplemented abstract method");};function Mc(a,b){H.call(this,b);this.I=a}h(Mc,H);k(Mc,H);Mc.prototype.getName=function(){return this.I};function Nc(a,b){this.nb=a;this.J=b}Nc.prototype.evaluate=function(a,b,c){y(b.k(),this.nb,a);c.O=a;this.J&&c.g(this.J);Oc(b,c)};function Oc(a,b){for(var c=b.J,d;c;d=c,c=c.f)if(c===a){d&&d.g(c.f);break}};function Pc(a,b,c){Nc.call(this,c,b);this.xb=a}k(Pc,Nc);Pc.prototype.evaluate=function(a,b,c){y(b.k(),this.nb,a);c.O=a;c.g(this.xb);this.J&&z(this.xb).g(this.J);Oc(b,c)};function P(a,b,c){x.call(this,c);this.Ua=a;this.j=b}k(P,x);
P.prototype.T=function(a,b,c){var d=Qc(this.k(),this.Ua.b);if(d instanceof Lc){var e;a:{for(e=this.j;e;e=e.c)if(e instanceof A){if(e instanceof M&&!e.d)throw new u("illegal empty application");if(!(e instanceof vb||e instanceof O||e instanceof dc)){e=!1;break a}}e=!0}if(e)c=this.Pa(),d.evaluate(c,this,a,b);else{d=new eb;b=new B;var g=void 0;for(e=this.j;e;e=e.c)if(e.Ka(),e instanceof O)C(b,e.clone(null));else if(e instanceof rc)g=sc(e,this.k(),c),C(b,new I(z(g).h)),fb(d,g);else{if(e.A())throw v();
(g=e.e(this.k()))instanceof x?(C(b,new I(z(g).h)),fb(d,g)):(g=e.clone(null),g instanceof K&&(g.d=null),C(b,g))}fb(d,new P(this.Ua,b.v));c=d.Fa;d=z(c);(b=this.f)&&d.g(b);d.h=this.h;a.g(c)}}else if(d instanceof Bc)b=new I(this.Ua.b),this.j&&(b.c=this.j),b=F(C(new B,b),M),d.evaluate(b,this,a,c);else if(d instanceof Nc)c=this.Pa()[0],d.evaluate(c,this,a);else{if(d instanceof A)throw new u("not a procedure");throw v();}};
P.prototype.Pa=function(){var a=void 0;a:{if(this.j instanceof I&&!this.j.c&&(a=this.k().get(this.j.b),a instanceof Array))break a;a=null}if(a)return a;for(var a=[],b=this.j;b;b=b.c)if(b instanceof I){var c=this.k().get(b.b);if(c instanceof Bc&&!c.Ra)throw new u("macro error");a.push(null===c?J:c)}else if(b instanceof O)a.push(b.d);else if(b instanceof Mc)a.push(b);else if(b instanceof A)a.push(b.clone(null));else throw v();return a};function Rc(a,b){P.call(this,a,null);this.yb=b}k(Rc,P);Rc.prototype.Pa=function(){return[this.yb]};function Sc(a,b,c,d){this.G=a;this.p=new Dc(c);if(b){for(a=new Tc;b&&ob(b)===na;b=b.c)c=b.d,c instanceof I&&"define"===c.b?C(a.i,fc(b)):Ob(b,a.hb,a);a.r=b;b=a.i;b.Ga()?a=qb(a.r,this.p):(b=new M(b.v),b.c=a.r,a=new P(new I("letrec"),b))}else a=null;this.r=(this.X=a)?z(this.X):null;this.I=void 0!==d?d:""+ba(this)}h(Sc,Lc);k(Sc,Lc);f=Sc.prototype;f.getName=function(){return this.I};f.toString=function(){return"proc:"+this.I};
f.P=function(a){if(a!==this.G.length)throw new u("incorrect number of args");};f.fb=function(a,b){for(var c=0;c<this.G.length;++c)y(b,this.G[c],a[c])};f.evaluate=function(a,b,c){var d=b.k(),e;if(this.r===b)d.sb=!0,e=d;else{e=new Dc(this.p);var g=this.p,G;for(G in g.Q){var D=e,E=g.Q[G],S=new E.constructor(E.G,null,e);S.p.Q=E.p.Q;S.X=E.X;S.r=E.r;y(D,G,S)}}g=b.f;d&&g&&!g.k()&&g.M(d);this.r&&(this.r.g(b.f),this.r.h=b.h);this.P(a.length);this.fb(a,e);this.X&&this.X.M(e);c.g(this.X)};
function Tc(){this.i=new B;this.r=null}Tc.prototype.hb=function(a){if(a instanceof K&&!(a instanceof O)){var b=a.d;b instanceof I&&"define"===b.b?C(this.i,fc(a)):a instanceof K&&Ob(a,this.hb,this)}};function Uc(a,b){switch(typeof b){case "number":return b+"";case "boolean":return b?"#t":"#f";case "string":return b;case "object":if(b===J)return"";if(b===Mb)return"\x3ceof\x3e";if(b instanceof Eb)return Uc(a,b.b);if(b instanceof M||b instanceof N){var c=Rb(b,ea(Uc,a));(b instanceof M&&b.A()||b instanceof N)&&c.splice(c.length-1,0,".");return"("+c.join(" ")+")"}return b instanceof dc?"#("+Rb(b,ea(Uc,a)).join(" ")+")":b instanceof Fb?a?'"'+b.b+'"':b.b:b instanceof Ab?a?(c=b.b," "===c?"#\\space":"\n"===
c?"#\\newline":"#\\"+c):b.b:b instanceof O?"'"+Uc(a,b.d):b instanceof Sc?"\x3cproc:"+b.getName()+"\x3e":xc(b)?"\x3cinput-port\x3e":uc(b)?"\x3coutput-port\x3e":b instanceof A?Uc(a,b.ca()):b.toString();default:return""}};function Vc(a,b,c,d){Sc.call(this,a,b,c,d)}h(Vc,Sc);k(Vc,Sc);Vc.prototype.P=function(a){if(a<this.G.length-1)throw new u("too few varargs");};Vc.prototype.fb=function(a,b){var c=void 0,d;for(d=0;d<this.G.length-1;++d)c=this.G[d],y(b,c,a[d]);if(0<this.G.length){for(var c=this.G[d],e=new B;d<a.length;++d)C(e,gc(a[d]));y(b,c,F(e,M))}};function Dc(a){this.D=a;this.i={};this.Q={};this.Wa=this.sb=!1}Dc.prototype.seal=function(){this.Wa=!0};Dc.prototype.clone=function(){if(this.D)throw v();var a=new Dc(null),b;for(b in this.i){var c=this.i[b];a.i[b]=c instanceof Bc?c.clone(a):c}return a};function Xb(a,b){return b in a.i||!!a.D&&Xb(a.D,b)}
Dc.prototype.get=function(a){if(a in this.i){var b=this.i[a];return gb(b)&&Xb(b,a)?b.get(a):b instanceof Bc?b:b instanceof Nc||b instanceof Lc?new Mc(a,b):b===J?b:b instanceof A?new Eb(b):b}if(a in this.Q)return this.Q[a];if(this.D)return this.D.get(a);throw new u("unbound variable");};
function Qc(a,b){if(b in a.i){var c=a.i[b];if(gb(c))return Qc(c,b);if(c instanceof Nc||c instanceof Bc||c instanceof Lc)return c;if(c instanceof A)throw new u("not a procedure");throw v();}return a.D?Qc(a.D,b):null}function y(a,b,c){if(a.Wa)throw v();if(b in a.i&&!a.sb&&"@"!==b.charAt(0))throw v();c instanceof Bc&&(c.Ca=a);a.i[b]=c instanceof A?c.ca():c}
function Fc(a,b,c,d){var e=a.i[b];if(null!=e||d)gb(e)?Fc(e,b,c,d):(delete a.i[b],y(a,b,c));else if(a.D)Fc(a.D,b,c,d);else throw new u("unbound variable");}Dc.prototype.toString=function(){return"\x3cenvironment-specifier\x3e"};Dc.prototype["$r5js.IEnvironment"]=!0;function Wc(){this.n=""}Wc.prototype.Ga=function(){return!this.n.length};Wc.prototype.ua=function(){return this.n.length?this.n.charAt(0):null};Wc.prototype.append=function(a){this.n+=a};function Xc(a){this.n=a;this.Gb=[]}Xc.prototype["$r5js.OutputPort"]=!0;Xc.prototype.write=function(a){this.n.append(a);this.Gb.push(a)};Xc.prototype.close=function(){};var Yc=Array.prototype,Zc=Yc.map?function(a,b,c){return Yc.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),g="string"==typeof a?a.split(""):a,G=0;G<d;G++)G in g&&(e[G]=b.call(c,g[G],G,a));return e};function $c(a,b){for(var c=a.length,d="string"==typeof a?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a))return e;return-1}function ad(a){return Yc.concat.apply(Yc,arguments)}function bd(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};function cd(a){this.q=a}f=cd.prototype;f.a=function(a){return"string"==typeof a?new dd(a):new ed(a,this.q)};f.l=function(a){return new fd(a,0,this.q)};f.o=function(a){return new fd(a,1,this.q)};f.t=function(a){return new gd(bd(arguments))};f.m=function(a){return new hd(bd(arguments))};f.list=function(a){var b=[];b.push(new dd("("));for(var c=0;c<arguments.length;++c)b.push(arguments[c]);b.push(new dd(")"));return new hd(b)};function id(a,b){return new hd([new dd("("),a,new dd("."),b])}
f.Ma=function(a){var b=[];b.push(new dd("#("));for(var c=0;c<arguments.length;++c)b.push(arguments[c]);b.push(new dd(")"));return new hd(b)};function jd(a){return new kd(a)}function dd(a){this.ya=a}
dd.prototype.match=function(a){if(")"===this.ya){if(a.f)a.f===ub?(a.f=a.ha.c,a=!0):a=!1;else{var b;if(b=a.ha.getParent())b=a.ha.getParent().c;a.f=b;a=!0}return a}b=a.f===ub?null:a.f;var c=!1;switch(this.ya){case "(":c=b instanceof M;break;case ".(":c=b instanceof N;break;case "#(":c=b instanceof dc;break;case "'":c=b instanceof O;break;case "`":c=b instanceof rc;break;case ",":c=b instanceof ac;break;case ",@":c=b instanceof bc;break;default:return b instanceof H&&b.b===this.ya?(a.ha=a.f,a.f=a.f.c,
!0):!1}c&&(a.ha=a.f,a.f=a.f.d||ub);return c};function ed(a,b){this.sa=a;this.q=b;this.$=null}ed.prototype.e=function(a){this.$=a;return this};ed.prototype.match=function(a){var b=this.q.wa(this.sa).match(a);b instanceof A&&(b.V.push(this.sa),this.$&&(b.Da.push(this.$),++b.ba),a.f=b.c);return b};function fd(a,b,c){this.sa=a;this.Db=b;this.q=c}fd.prototype.match=function(a){for(var b=0,c=void 0;c=this.q.wa(this.sa).match(a);)c.V.push(this.sa),++b;return b>=this.Db};function kd(a){this.Hb=a}
kd.prototype.match=function(a){var b=a.f===ub?null:a.f;return b&&this.Hb(b)?(a.ha=a.f,a.f=a.f.c,!0):!1};function gd(a){this.B=a}gd.prototype.match=function(a){for(var b=void 0,c=0;c<this.B.length;++c)if(b=this.B[c].match(a))return b;return!1};function hd(a){this.B=nd(a);this.$=null}hd.prototype.match=function(a){for(var b=a.f===ub?null:a.f,c=0;c<this.B.length;++c)if(!this.B[c].match(a))return a.f=b,!1;a.f=b&&b.c;b instanceof A&&this.$&&(b.Da.push(this.$),++b.ba);return b||!1};
function nd(a){var b=$c(a,function(a){return a instanceof dd&&"."===a.ya});if(-1===b)return a;for(var c=b-1;0<=c;--c){var d=a[c];if(d instanceof dd&&"("===d.ya){a[c]=new dd(".(");break}}a.splice(b,2);return a}hd.prototype.e=function(a){this.$=a;return this};function od(a){this.zb=new tb(a)}od.prototype.parse=function(a){var b=a||Aa;if(a=Q[b].match(this.zb)){if(b===Aa&&a!=xb&&!ob(a))return null;a.V.push(b)}if(b===Aa&&a&&pd){pd=!1;b=new kb(null);a.F(b);var c;b:{for(c in b.i){c=!0;break b}c=!1}a=c?(new od(a)).parse():a}return a};function qd(a,b,c){var d=new B;Ob(Qb(a),function(a){var c=L(a,pa).clone(null);a=L(a,Na).e(b);var e=new B;C(e,c);C(e,new Db(a));C(d,F(e,M))});var e=new B;C(C(e,F(d,M)),Qb(a).c);return new P(new I(c),e.v)}var pd=!1,Q={};
function rd(){}rd.prototype.wa=function(a){return Q[a]};var R=new cd(new rd);Q[n]=R.t(R.a(q),R.a(sa),R.a(qa),R.a(ka),R.a(ha),R.a(Ba).e(function(a){return a.W(1)}),R.list(R.a("begin"),R.o(n)).e(function(a,b){return qb(L(a,n),b)}),R.a(ta),R.a(za),R.a(ua));Q[q]=R.m(jd(function(a){var b=a instanceof I;b&&ib(a.b)&&(pd=!0);return b}));Q[sa]=R.t(R.a(Fa),R.a(Ca));Q[Ca]=R.m(R.a("'"),R.a(m));Q[m]=R.m(jd(function(){return!0}));
Q[Fa]=R.m(jd(function(a){var b=a instanceof H&&!(a instanceof I)||a instanceof dc;a instanceof Fb&&nb(a);return b}));Q[za]=R.list(R.a(wa),R.l(va)).e(function(a,b){var c=L(a,wa),d=L(a,va);if(c instanceof I)return new P(c,d);var c=c.e(b),e=z(c);e.g(new P(new I(e.h),d));return c});Q[wa]=R.a(n);Q[va]=R.a(n);
Q[qa]=R.list(R.a("lambda"),R.a(oa),R.l(na),R.o(n)).e(function(a,b){var c=L(a,oa),d=void 0,e=!1;c instanceof M?d=Rb(c,function(a){return a.b}):(d=c.A()?Rb(c,function(a){return a.b}):[c.b],e=!0);var g="proc"+ba({}),c=e?new Vc(d,c.c,b,g):new Sc(d,c.c,b,g);if(b.Wa)throw v();if(b.Q[g])throw v();b.Q[g]=c;return(new I(g)).N()});Q[oa]=R.t(R.list(R.l(q)),R.a(q),id(R.o(q),R.a(q)));
Q[na]=R.t(R.list(R.a("define"),R.a(q),R.a(n)).e(function(a,b){var c=L(a,q),d=c.c.e(b,!0),e=z(d);e.g(Ic(c.b,e.h));return d}),R.list(R.a("define"),R.list(R.o(q)),R.l(na),R.o(n)).e(function(a,b){var c=Nb(fc(a)),d=c.c.d.c,e=Rb(d,function(a){return a.b}),g="proc"+ba({});y(b,g,new Sc(e,d.c,b,c.b));return Ic(c.b,g)}),R.list(R.a("define"),id(R.o(q),R.a(q)),R.l(na),R.o(n)).e(function(a,b){var c=Nb(fc(a)),d=c.c.d.c,e=d instanceof K?Rb(d,function(a){return a.b}):[d.b],g="proc"+ba({});y(b,g,new Vc(e,d.c,b,c.b));
return Ic(c.b,g)}),R.list(R.a("begin"),R.l(na)).e(function(a,b){var c=L(a,na);return c&&qb(c,b)}));Q[ka]=R.t(R.list(R.a("if"),R.a(Ma),R.a(la),R.a(ga)).e(function(a,b){var c=L(a,Ma).e(b,!0),d=L(a,la).e(b,!0),e=L(a,ga).e(b,!0),g=z(c),d=new db(g.h,d,e);g.g(d);return c}),R.list(R.a("if"),R.a(Ma),R.a(la)).e(function(a,b){var c=L(a,Ma).e(b,!0),d=L(a,la).e(b,!0),e=z(c),d=new db(e.h,d,J.N());e.g(d);return c}));Q[Ma]=R.a(n);Q[la]=R.a(n);Q[ga]=R.a(n);
Q[ha]=R.list(R.a("set!"),R.a(q),R.a(n)).e(function(a,b){var c=L(a,q),d=c.c.e(b,!0),e=z(d);e.g(Gc(c.b,e.h));return d});Q[Ba]=R.m(R.a("`"),R.a(Da));Q[Da]=R.t(jd(function(a){return a instanceof H}),R.a(ra),R.a(Pa),R.a(Oa));Q[ra]=R.t(R.list(R.l(Ea)),id(R.o(Ea),R.a(Ea)),R.m(R.a("'"),R.a(Da)),R.a(Ba));Q[Pa]=R.Ma(R.l(Ea));Q[Oa]=R.m(R.a(","),R.a(Da));Q[Ea]=R.t(R.m(R.a(Da)),R.a(Ga));Q[Ga]=R.m(R.a(",@"),R.a(Da));Q[ua]=R.list(R.a(pa),R.l(m)).e(function(a){return new P(L(a,pa),L(a,m))});
Q[pa]=R.m(jd(function(a){return a instanceof I}));Q[ta]=R.t(R.list(R.a("let-syntax"),R.list(R.l(Ja)),R.l(na),R.o(n)).e(function(a,b){return qd(a,b,"let")}),R.list(R.a("letrec-syntax"),R.list(R.l(Ja)),R.l(na),R.o(n)).e(function(a,b){return qd(a,b,"letrec")}));Q[Ja]=R.list(R.a(pa),R.a(Na));Q[Na]=R.list(R.a("syntax-rules"),R.list(R.l(ya)),R.l(Ia)).e(function(a,b){return new Bc(L(Qb(a),ya),L(a,Ia),b)});Q[Ia]=R.list(R.a(p),R.a(Ka));
Q[p]=R.t(R.list(R.o(p),R.a("...")).e(function(a,b){for(var c=new oc,d=L(a,p);d;d=d.c){var e=d.c;if(e instanceof H&&"..."===e.b){lc(c,new $b(d.e(b)));break}else lc(c,d.e(b))}return c}),R.Ma(R.o(p),R.a("...")).e(function(a,b){for(var c=new nc,d=L(a,p);d;d=d.c){var e=d.c;if(e instanceof I&&"..."===e.b){lc(c,new $b(d.e(b)));break}else lc(c,d.e(b))}return c}),R.a(ya).e(function(a){return new Yb(a)}),R.list(R.l(p)).e(function(a,b){for(var c=new oc,d=L(a,p);d;d=d.c)lc(c,d.e(b));return c}),R.m(R.a("("),R.o(p),
R.a("."),R.a(p),R.a(")")).e(function(a,b){for(var c=new pc,d=L(a,p);d;d=d.c)lc(c,d.e(b));return c}),R.Ma(R.l(p)).e(function(a,b){for(var c=new nc,d=L(a,p);d;d=d.c)lc(c,d.e(b));return c}),R.a(xa).e(function(a){return new Yb(a)}));Q[xa]=R.m(jd(function(a){return a instanceof H&&!(a instanceof I)}));
Q[Ka]=R.t(R.a(ya).e(function(a){return new Zb(a)}),R.m(R.a("...")),R.a(La).e(function(a){return new Zb(a)}),id(R.o(Ka),R.a(Ka)).e(function(a,b){for(var c=new pc,d=L(a,Ka);d;d=d.c){var e=d.c;e instanceof I&&"..."===e.b?(lc(c,new $b(d.e(b))),d=d.c):lc(c,d.e(b))}return c}),R.list(R.l(Ka)).e(function(a,b){for(var c=new oc,d=L(a,Ka);d;d=d.c){var e=d.c;e instanceof I&&"..."===e.b?(lc(c,new $b(d.e(b))),d=d.c):lc(c,d.e(b))}return c}),R.Ma(R.l(Ka)).e(function(a,b){for(var c=new nc,d=L(a,Ka);d;d=d.c){var e=
d.c;e instanceof I&&"..."===e.b?(lc(c,new $b(d.e(b))),d=d.c):lc(c,d.e(b))}return c}),R.m(R.a("'"),R.a(Ka)).e(function(a,b){var c=new mc;lc(c,L(a,Ka).e(b));return c}));Q[La]=R.a(xa);Q[ya]=R.m(jd(function(a){return a instanceof I&&"..."!==a.b}));Q[Aa]=R.m(R.l(ja)).e(function(a,b){return a===xb?a:qb(a,b)});Q[ja]=R.t(R.a(na),R.a(Ha),R.a(na),R.a(Ha),R.list(R.a("begin"),R.l(ja)).e(function(a,b){var c=L(a,ja);return c&&qb(c,b)}),R.a(ia));Q[ia]=R.a(n);
Q[Ha]=R.list(R.a("define-syntax"),R.a(pa),R.a(Na)).e(function(a,b){var c=L(a,pa).b,d=L(a,Na).e(b),e;a:{for(e=0;e<d.ka.length;++e)if(d.ka[e].getName()!==c){e=!1;break a}e=!0}if(!e)throw new u("macro error");e="proc"+ba({});y(b,e,d);return Kc(c,e)});function sd(a){this.q=a}f=sd.prototype;f.a=function(a){return new td(a,this.q)};f.l=function(a){return new ud(a,0,this.q)};f.o=function(a){return new ud(a,1,this.q)};f.m=function(a){return new vd(bd(arguments))};f.t=function(a){return new wd(bd(arguments))};function td(a,b){this.la=a.toString();this.q=b}td.prototype.match=function(a){var b=this.q.wa(this.la);return b?b.match(a):Kb(a)===this.la?xd:null};var xd=new A;function ud(a,b,c){this.la=a.toString();this.Jb=b;this.q=c}
ud.prototype.match=function(a){for(var b=new B,c=this.q.wa(this.la),d=a.ga,e=0,g;g=c.match(a);)C(b,g),++e;if(e>=this.Jb)return b.v||xb;a.restore(d);return null};function yd(a){this.ea=a}yd.prototype.match=function(a){a=Kb(a);return a instanceof this.ea?a:null};function vd(a){this.B=a;this.ea=null}function zd(a,b){a.ea=b;return a}
vd.prototype.match=function(a){for(var b=new B,c=a.ga,d=0;d<this.B.length;++d){var e=this.B[d].match(a);if(e!==xd&&e!==xb)if(e)C(b,e);else return a.restore(c),null}return Ad(F(b,this.ea))};function Ad(a){if(!(a instanceof M&&a.d))return a;var b=a.d;if(!(b instanceof H))return a;var c=b.c;switch(b.b){case "quote":return new O(c);case "quasiquote":return new rc(c);case "unquote":return new ac(c);case "unquote-splicing":return new bc(c);default:return a}}function wd(a){this.B=a}
wd.prototype.match=function(a){for(var b=0;b<this.B.length;++b){var c=a.ga,d=void 0;if(d=this.B[b].match(a))return d;a.restore(c)}return null};function Bd(){}Bd.prototype.wa=function(a){return Cd[a]};var Cd={},T=new sd(new Bd);Cd[m.toString()]=T.t(new yd(I),new yd(Bb),new yd(Cb),new yd(Ab),new yd(Fb),zd(T.m(T.a("("),T.l(m),T.a(")")),M),zd(T.m(T.a("("),T.o(m),T.a("."),T.a(m),T.a(")")),N),zd(T.m(T.a("#("),T.l(m),T.a(")")),dc),zd(T.m(T.a("'"),T.a(m)),O),zd(T.m(T.a("`"),T.a(m)),rc),zd(T.m(T.a(","),T.a(m)),ac),zd(T.m(T.a(",@"),T.a(m)),bc));Cd[ma.toString()]=T.l(m);function Dd(a){this.vb=a}
Dd.prototype.L=function(){var a=Cd[ma.toString()].match(this.vb);if(Kb(this.vb))throw new u("read error");return a};function U(a){for(var b in Ya){var c=Ya[b],d=c.getName()+"?";if(d in V&&V[d].aa.call(null,a))return c}throw v();}function W(a,b){return new X(a,Ed,void 0!==b?new Fd([b]):Gd)}function Hd(a){this.Fb=a}Hd.prototype.P=function(a){if(a!==this.Fb)throw new u("incorrect number of args");};function Id(a){this.Eb=a}Id.prototype.P=function(a){if(a<this.Eb)throw new u("too few varargs");};function Jd(a,b){this.Cb=a;this.Bb=b}
Jd.prototype.P=function(a){if(a<this.Cb)throw new u("too few varargs");if(a>this.Bb)throw new u("too many varargs");};var Ed=new Hd(1),Kd=new Hd(2),Ld=new Hd(3),Md=new Id(0),Nd=new Id(1);function Fd(a){this.cb=a}Fd.prototype.oa=function(a){for(var b=[],c=0;c<this.cb.length;++c){var d=a[c];if(!V[this.cb[c].getName()+"?"].aa.call(null,d))throw U(d),new u($a);b.push(d instanceof A?d.ca():d)}return b};function Od(){}Od.prototype.oa=function(a){return a};var Gd=new Od;function Pd(a){this.la=a}
Pd.prototype.oa=function(a){var b=this.la;return Zc(a,function(a){if(!V[b.getName()+"?"].aa.call(null,a))throw w(U(a));return a instanceof A?a.ca():a})};function X(a,b,c){this.aa=a;this.Ta=b;this.ab=c;this.S=""}h(X,Lc);k(X,Lc);X.prototype.toString=function(){return"\x3cproc:"+this.S+"\x3e"};X.prototype.call=function(a,b,c){this.Ta.P(a.length,this.S);a=this.ab.oa(a,this.S);a=this.aa.apply(null,a);cb(b,a);c.O=a;(b=b.f)&&c.g(b)};
X.prototype.evaluate=function(a,b,c){a=a.map(gc);for(var d=0;d<a.length;++d)a[d]instanceof Eb&&(a[d]=a[d].b);this.call(a,b,c)};function Qd(a,b,c){X.call(this,a,b,c)}h(Qd,X);k(Qd,X);Qd.prototype.call=function(a,b,c){this.Ta.P(a.length,this.S);a=this.ab.oa(a,this.S);a=ad(c.Qa,c.Va,bd(a));a=this.aa.apply(null,a);cb(b,a);c.O=a;(b=b.f)&&c.g(b)};function Rd(a,b,c){X.call(this,a,b,c)}h(Rd,X);k(Rd,X);
Rd.prototype.call=function(a,b,c){this.Ta.P(a.length,this.S);a=this.ab.oa(a,this.S);b=ad(bd(a),b,c);this.aa.apply(null,b)};function Y(a,b,c){var d=[];void 0!==b&&d.push(b);void 0!==c&&d.push(c);return new X(a,Kd,0===d.length?Gd:new Fd(d))}function Sd(a,b,c,d){var e=[];b&&e.push(b);c&&e.push(c);d&&e.push(d);return new X(a,Ld,e.length?new Fd(e):Gd)}function Td(a){return new X(a,Md,new Pd(t))}function Ud(a){return new X(a,Nd,new Pd(t))}function Vd(a){return new X(a,new Jd(1,2),Gd)}
function Wd(a){return new Qd(a,new Hd(0),Gd)}function Xd(a){return new Qd(a,new Jd(0,1),Gd)}function Yd(a){return new Qd(a,new Jd(1,2),Gd)}function Zd(a,b){return new Rd(b,new Id(a),Gd)}var V={};V["boolean?"]=W(function(a){return a instanceof Bb});V["char?"]=W(function(a){return a instanceof Ab});V["input-port?"]=W(function(a){return xc(a)});V["null?"]=W(function(a){return a instanceof M&&!a.d});V["number?"]=W(function(a){return a instanceof Cb});V["output-port?"]=W(function(a){return uc(a)});
V["pair?"]=W(function(a){return!(!a||!a["$r5js.IPair"])&&!!a.d});V["port?"]=W(function(a){return xc(a)||uc(a)});V["procedure?"]=W(function(a){return a instanceof Mc||a instanceof Nc});V["string?"]=W(function(a){return a instanceof Fb});V["symbol?"]=W(function(a){return a instanceof I});V["vector?"]=W(function(a){return a instanceof dc});function $d(a){return new od(a)}function ae(a,b,c,d){for(c=new Ac(c,d);a;)d=a.k(),!d&&b&&a.M(b),a.T(c,b,$d),b=d=a.k(),a.p=null,a=c.J,c.clear();return c.O};function be(a){this.p=new Dc(a)}be.prototype.L=function(a){return(new Dd(a)).L()};be.prototype.parse=function(a,b){var c=new od(a),c=void 0!==b?c.parse(b):c.parse();if(!c)throw new u("parse error");return c};be.prototype.e=function(a){return a.e(this.p,!1)};function ce(a,b,c){this.Ja=a;this.Qa=b;this.Va=c}ce.prototype.evaluate=function(a){a=this.Ja.e(this.Ja.parse(this.Ja.L(new Ib(a))));a=a===xb?J:ae(a,this.Ja.p,this.Qa,this.Va);return Uc(!0,a)};function de(a){this.n=a;this.Ha=null}f=de.prototype;f.lb=function(){return!this.n.Ga()};f.close=function(){};f.L=function(){var a=this.Ha;a&&(this.Ha=this.Ha.c);if(a)return a;if(this.n.Ga())return null;var a=this.n,b=a.n;a.n="";this.Ha=(new Dd(new Ib(b))).L();return this.L()};f.ua=function(){var a=this.n.ua();return a?new Ab(a):null};f.rb=function(){var a=this.n,b=a.ua();b&&(a.n=a.n.substr(1));return b?new Ab(b):null};de.prototype["$r5js.InputPort"]=!0;function ee(){this.da={}};var fe=null,ge=null,he=null,Z={},ie;for(ie in V)Z[ie]=V[ie];Z["eqv?"]=Z["eq?"]=Y(function(a,b){return a.ra(b)});Z["\x3d"]=Td(function(){for(var a=0;a<arguments.length-1;++a)if(arguments[a]!==arguments[a+1])return!1;return!0});Z["/"]=Ud(function(){if(1===arguments.length)return 1/arguments[0];for(var a=arguments[0],b=1;b<arguments.length;++b)a/=arguments[b];return a});
Z["-"]=Ud(function(){if(1===arguments.length)return-1*arguments[0];for(var a=arguments[0],b=1;b<arguments.length;++b)a-=arguments[b];return a});Z["*"]=Td(function(){for(var a=1,b=0;b<arguments.length;++b)a*=arguments[b];return a});Z["+"]=Td(function(){for(var a=0,b=0;b<arguments.length;++b)a+=arguments[b];return a});Z["\x3e\x3d"]=Td(function(){for(var a=0;a<arguments.length-1;++a)if(arguments[a]<arguments[a+1])return!1;return!0});
Z["\x3e"]=Td(function(){for(var a=0;a<arguments.length-1;++a)if(arguments[a]<=arguments[a+1])return!1;return!0});Z["\x3c\x3d"]=Td(function(){for(var a=0;a<arguments.length-1;++a)if(arguments[a]>arguments[a+1])return!1;return!0});Z["\x3c"]=Td(function(){for(var a=0;a<arguments.length-1;++a)if(arguments[a]>=arguments[a+1])return!1;return!0});Z.angle=W(function(){throw new u("unimplemented option");},t);Z.acos=W(Math.acos,t);Z.asin=W(Math.asin,t);
Z.atan=Ud(function(){switch(arguments.length){case 1:return Math.atan(arguments[0]);case 2:return Math.atan2(arguments[0],arguments[1]);default:throw new u("too many varargs");}});Z.ceiling=W(Math.ceil,t);Z["complex?"]=W(function(a){return a instanceof Cb});Z.cos=W(Math.cos,t);Z["exact?"]=W(function(){return!1},t);Z["exact-\x3einexact"]=W(function(a){return a},t);Z.exp=W(Math.exp,t);Z.expt=Y(Math.pow,t,t);Z.floor=W(Math.floor,t);Z["imag-part"]=W(function(){throw new u("unimplemented option");},t);
Z["inexact?"]=W(function(){return!0},t);Z["inexact-\x3eexact"]=W(function(a){return a},t);Z.magnitude=W(function(){throw new u("unimplemented option");},t);Z["make-polar"]=Y(function(){throw new u("unimplemented option");},t,t);Z["make-rectangular"]=Y(function(){throw new u("unimplemented option");},t,t);Z["number-\x3estring"]=W(function(a){return new Fb(a+"")},t);Z["integer?"]=W(function(a){return a instanceof Cb&&Math.round(a.b)===a.b});Z.log=W(Math.log,t);
Z.modulo=Y(function(a,b){var c=a%b,d=c;if(0<a*b)return c;if(0<a)for(;0<d;)d+=b;else for(;0>d;)d+=b;return d},t,t);Z.quotient=Y(function(a,b){var c=a/b;return 0<c?Math.floor(c):Math.ceil(c)},t,t);Z["rational?"]=W(function(a){return a instanceof Cb});Z["real?"]=W(function(a){return a instanceof Cb});Z["real-part"]=W(function(){throw new u("unimplemented option");},t);Z.remainder=Y(function(a,b){return a%b},t,t);
Z.round=W(function(a){var b=Math.floor(a),c=Math.abs(a-b),d=Math.ceil(a);a=Math.abs(d-a);return a<c?d:c<a?b:d%2?b:d},t);Z.sin=W(Math.sin,t);Z.sqrt=W(Math.sqrt,t);Z["string-\x3enumber"]=W(parseFloat,Va);Z.tan=W(Math.tan,t);Z.truncate=W(function(a){return 0<a?Math.floor(a):Math.ceil(a)},t);Z.car=W(function(a){return a.Na()},Ua);Z.cdr=W(function(a){var b=a.Oa();b instanceof K&&(b.Y=new cc(a,b.d));return b},Ua);
Z.cons=Y(function(a,b){var c=a.clone(),d=b.clone();if(d instanceof M||d.A()){var e=d.d;d.d=c;c.c=e;return d}return F(C(C(new B,c),d),N)});Z["set-car!"]=Y(function(a,b){if(!(a instanceof M||a.A()))throw w(U(a));if(a.H)throw ab();b.c=a.d.c;a.d=b;var c=a.Y;if(c){if(c.C.H)throw ab();c.C.d.c=b}return J});
Z["set-cdr!"]=Y(function(a,b){if(!(a instanceof M||a.A()))throw w(U(a));if(a.H)throw ab();a.d.c=b instanceof M?b.d:b;var c=a.Y;if(c){if(c.C.H)throw ab();c.xa.c=b;if(!(b instanceof M)){do c.C instanceof M&&(c.C.Ea=!0);while(c=c.C.Y)}}a instanceof M&&(a.jb=!0);return J});Z["make-vector"]=Vd(function(a,b){if(!(a instanceof Cb))throw w(U(a));var c=a.b;b=b||new Bb(!1);for(var d=[],e=0;e<c;++e)d.push(b.clone());return new dc(d)});Z["vector-length"]=W(function(a){a.na||ec(a);return a.Aa.length},Xa);
Z["vector-ref"]=Y(function(a,b){a.na||ec(a);return a.Aa[b]},Xa,t);Z["vector-set!"]=Sd(function(a,b,c){if(!(a instanceof dc))throw w(U(a));if(!(b instanceof Cb))throw w(U(b));if(a.H)throw ab();b=b.b;a.na||ec(a);a.Aa[b]=c;return J});Z["symbol-\x3estring"]=W(function(a){return nb(new Fb(a))},Wa);Z["string-\x3esymbol"]=W(function(a){return new I(a.b)},Va);Z["char\x3d?"]=Y(function(a,b){return a.b===b.b},r,r);Z["char\x3c?"]=Y(function(a,b){return a.b<b.b},r,r);
Z["char\x3e?"]=Y(function(a,b){return a.b>b.b},r,r);Z["char\x3c\x3d?"]=Y(function(a,b){return a.b<=b.b},r,r);Z["char\x3e\x3d?"]=Y(function(a,b){return a.b>=b.b},r,r);Z["char-\x3einteger"]=W(function(a){return a.b.charCodeAt(0)},r);Z["integer-\x3echar"]=W(function(a){return new Ab(String.fromCharCode(a))},t);Z["char-upcase"]=W(function(a){return new Ab(a.b.toUpperCase())},r);Z["char-downcase"]=W(function(a){return new Ab(a.b.toLowerCase())},r);
Z["make-string"]=Vd(function(a,b){for(var c=void 0!==b?b.b:" ",d=a.b,e="",g=0;g<d;++g)e+=c;return new Fb(e)});Z["string-length"]=W(function(a){return a.b.length},Va);Z["string-ref"]=Y(function(a,b){return new Ab(a.b.charAt(b))},Va,t);Z["string-set!"]=Sd(function(a,b,c){if(a.H)throw ab();var d=a.b;a.b=d.substr(0,b)+c.b+d.substr(b+1);return J},Va,t,r);
Z.eval=new Qd(function(a,b,c,d){if(!(c instanceof A))throw w(U(c));if(!gb(d))throw w(U(d));if(c instanceof Mc)return new I(c.getName());c.c=null;c=(new od(c)).parse();if(!c)throw new u("parse error");c=c.e(d);return ae(c,d,a,b)},new Hd(2),Gd);Z["will-eval?"]=Y(function(a){try{return Z.eval.aa.call(null,a),!0}catch(b){return!1}});Z["char-ready?"]=Xd(function(a,b,c){a=c||a;if(!xc(a))throw w(U(a));return a.lb()});Z["close-input-port"]=W(function(a){a.close();return J},Ra);
Z["close-output-port"]=W(function(a){a.close();return J},Ta);Z["current-input-port"]=Wd(function(a){return a});Z["current-output-port"]=Wd(function(a,b){return b});Z.display=Yd(function(a,b,c,d){a=d||b;if(!uc(a))throw w(U(a));a.write(Uc(!1,c));return J});Z["eof-object?"]=W(function(a){return a===Mb});Z["open-input-file"]=W(function(a){a=a.b;var b=he;a in b.da||(b.da[a]=new Wc);return new de(b.da[a])},Va);
Z["open-output-file"]=W(function(a){a=a.b;var b=he;a in b.da||(b.da[a]=new Wc);return new Xc(b.da[a])},Va);Z["peek-char"]=Xd(function(a,b,c){a=c||a;if(!xc(a))throw w(U(a));return a.ua()||Mb});Z.read=Xd(function(a,b,c){a=c||a;if(!xc(a))throw w(U(a));return a.L()||Mb});Z["read-char"]=Xd(function(a,b,c){a=c||a;if(!xc(a))throw w(U(a));return a.rb()||Mb});Z.write=Yd(function(a,b,c,d){a=d||b;if(!uc(a))throw w(U(a));a.write(Uc(!0,c));return J});
Z["write-char"]=Yd(function(a,b,c,d){if(!(c instanceof Ab))throw w(U(c));a=d||b;if(!uc(a))throw w(U(a));a.write(Uc(!0,c));return J});
Z.apply=Zd(2,function(){var a=arguments[0];if(!(a instanceof Mc))throw w(U(a));var b=new I(a.getName()),a=arguments[arguments.length-2],c=arguments[arguments.length-1],d=arguments.length-3,e=arguments[d];if(!(e instanceof M))throw w(U(e));if(1===d){d=new B;for(e=e.d;e;e=e.c)C(d,new O(e));b=new P(b,d.v)}else{for(var g=1;g<d-1;++g)arguments[g].c=arguments[g+1];arguments[d-1].c=e.d;e=wb(C(new B,arguments[1]));b=new P(b,e)}b.g(a.f);b.h=a.h;c.g(b);return J});
Z["dynamic-wind"]=new Rd(function(a,b,c,d,e){a=new P(d.j,null);b=new P(d.j.c.c,null);c=new P(d.j.c,null);var g=(new I(c.h)).N();z(b).g(g);z(b).g(d.f);z(c).g(b);z(a).g(c);e.g(a);d=new P(d.j,null,a.h);e.eb=d;return J},Ld,Gd);Z["call-with-values"]=new Rd(function(a,b,c,d){a=new P(c.j,null);b=new P(c.j.c,new I(a.h));b.g(c.f);a.g(b);d.g(a);return J},Kd,Gd);
Z["call-with-current-continuation"]=new Rd(function(a,b,c){a=b.f;var d=b.h,e=c.eb,d=new Rc(b.j,e?new Pc(e,a,d):new Nc(d,a));a&&d.g(a);d.h=b.h;c.g(d);return J},Ed,Gd);Z.values=Zd(1,function(){var a=arguments[arguments.length-1],b=arguments[arguments.length-2],c=arguments[arguments.length-2],d=arguments.length-2;if(1===d)y(c.k(),b.h,arguments[0]);else{for(var e=[],g=0;g<d;++g)e.push(arguments[g]);y(c.k(),b.h,e)}(b=b.f)&&b.M(c.k());a.g(b);return J});
Z["null-environment"]=W(function(a){if(5!==a)throw new u("unimplemented option");return new Dc(fe)},t);Z["scheme-report-environment"]=W(function(a){if(5!==a)throw new u("unimplemented option");return new Dc(ge)},t);function je(a,b){var c=(new od((new Dd(new Ib(a))).L())).parse().e(b);ae(c,b,zc,wc)};var ke=null;function le(a){if(!ke){var b=new fa,c=b.Ib,d=new Dc(null);je(b.Kb,d);d.seal();b=d.clone();fe=d;ge=b;he=new ee;for(var e in Z)d=Z[e],d.S=e,y(b,e,d);je(c,b);b.seal();ke=new ce(new be(b),zc,wc)}return ke.evaluate(a)}var me=["EVAL"],ne=this;me[0]in ne||!ne.execScript||ne.execScript("var "+me[0]);for(var oe;me.length&&(oe=me.shift());)me.length||void 0===le?ne=ne[oe]?ne[oe]:ne[oe]={}:ne[oe]=le;